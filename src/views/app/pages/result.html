<ng-include src="'views/common/errors/error404.html'" ng-init="vm=vm"></ng-include>

<div class="row animated bounceInRight" ng-if="vm.deal">
    <div class="col">
        <div class="d-flex justify-content-between align-items-center mb-2">
            <h1 class="text-white font-weight-xlight mb-0">{{vm.deal.name}}</h1>
            <div>
                <button class="btn btn-transparent" ng-click="vm.edit()">
                    <span class="text-capitalize">{{'EDIT' | translate}}</span>
                    <span class="fa fa-pencil-alt ml-1"></span>
                </button>
                <button class="btn btn-transparent ml-1" ng-click="vm.save()">
                    <span class="text-capitalize">{{'SAVE' | translate}}</span>
                    <span class="fa fa-save ml-1"></span>
                </button>
            </div>
        </div>
        <uib-tabset type="tabs" active="vm.activeTab" ng-if="vm.dealRes.remainingTerm.mortgageBalance">
            <uib-tab>
                <uib-tab-heading>
                    <span class="text-uppercase">{{'KPI' | translate}}</span>
                </uib-tab-heading>
                <div class="card bg-transparent border-0">
                    <div class="card-body animated fadeIn">
                        <uib-tabset type="pills" active="vm.activeTab2">
                            <uib-tab>
                                <uib-tab-heading>
                                    <span class="text-capitalize">{{'INITIAL_TERM' | translate}}</span>
                                </uib-tab-heading>
                                <div class="row animated fadeIn">
                                    <div class="col-12 col-md-6 col-lg-3 mb-4">
                                        <div class="card bg-lazur h-100 text-white text-center">
                                            <div class="card-body px-2 py-3">
                                                <h5 class="text-capitalize mb-0">{{'MONTHLY_PAYMENT' | translate}}</h5>
                                                <small><em>{{'MONTHLY_PAYMENT_SUB_INFO' | translate: {fixedTermTerm: vm.dealRes.fixedTerm.term, fixedTermRate: vm.dealRes.fixedTerm.rate} }}</em></small>
                                                <h1>£{{vm.dealRes.fixedTerm.monthlyPayments | number : 2}}</h1>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-12 col-md-6 col-lg-3 mb-4">
                                        <div class="card bg-purple h-100 text-white text-center">
                                            <div class="card-body px-2 py-3">
                                                <h5 class="text-capitalize mb-0">{{'COST' | translate}}</h5>
                                                <small><em>{{'COST_SUB_INFO' | translate}}</em></small>
                                                <h1>£{{vm.dealRes.summary.cost.fixedTerm | number : 2}}</h1>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-12 col-md-6 col-lg-3 mb-4">
                                        <div class="card bg-lazur h-100 text-white text-center">
                                            <div class="card-body px-2 py-3">
                                                <h5 class="text-capitalize mb-0">{{'TOTAL_PAID' | translate}}</h5>
                                                <small>&nbsp;</small>
                                                <h1>£{{vm.dealRes.summary.payments.fixedTerm | number : 2}}</h1>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-12 col-md-6 col-lg-3 mb-4">
                                        <div class="card bg-lazur h-100 text-white text-center">
                                            <div class="card-body px-2 py-3">
                                                <h5 class="mb-0">{{'COST_PER_1_POUND' | translate}}</h5>
                                                <small>&nbsp;</small>
                                                <h1>£{{(vm.dealRes.summary.payments.fixedTerm + vm.dealRes.summary.valuationFee.fixedTerm + vm.dealRes.summary.bookingFee.fixedTerm) / vm.dealRes.summary.capitalGain.fixedTerm | number : 2}}</h1>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </uib-tab>
                            <uib-tab>
                                <uib-tab-heading>
                                    <span class="text-capitalize">{{'REMAINING_TERM' | translate}}</span>
                                </uib-tab-heading>
                                <div class="row animated fadeIn">
                                    <div class="col-12 col-md-6 col-lg-3 mb-4">
                                        <div class="card bg-lazur h-100 text-white text-center">
                                            <div class="card-body px-2 py-3">
                                                <h5 class="text-capitalize mb-0">{{'MONTHLY_PAYMENT' | translate}}</h5>
                                                <small><em>{{'MONTHLY_PAYMENT_SUB_INFO' | translate: {fixedTermTerm: vm.dealRes.remainingTerm.term, fixedTermRate: vm.dealRes.remainingTerm.rate} }}</em></small>
                                                <h1>£{{vm.dealRes.remainingTerm.monthlyPayments | number : 2}}</h1>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-12 col-md-6 col-lg-3 mb-4">
                                        <div class="card bg-purple h-100 text-white text-center">
                                            <div class="card-body px-2 py-3">
                                                <h5 class="text-capitalize mb-0">{{'COST' | translate}}</h5>
                                                <small><em>{{'COST_PER_1_POUND' | translate}}</em></small>
                                                <h1>£{{vm.dealRes.summary.cost.remainingTerm | number : 2}}</h1>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-12 col-md-6 col-lg-3 mb-4">
                                        <div class="card bg-lazur h-100 text-white text-center">
                                            <div class="card-body px-2 py-3">
                                                <h5 class=" text-capitalize mb-0">{{'TOTAL_PAID' | translate}}</h5>
                                                <small>&nbsp;</small>
                                                <h1>£{{vm.dealRes.summary.payments.remainingTerm | number : 2}}</h1>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-12 col-md-6 col-lg-3 mb-4">
                                        <div class="card bg-lazur h-100 text-white text-center">
                                            <div class="card-body px-2 py-3">
                                                <h5 class="mb-0">{{'COST_PER_1_POUND' | translate}}</h5>
                                                <small>&nbsp;</small>
                                                <h1>£{{(vm.dealRes.summary.payments.remainingTerm + vm.dealRes.summary.valuationFee.remainingTerm + vm.dealRes.summary.bookingFee.remainingTerm) / vm.dealRes.summary.capitalGain.remainingTerm | number : 2}}</h1>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </uib-tab>
                            <uib-tab>
                                <uib-tab-heading>
                                    <span class="text-capitalize">{{'WHOLE_TERM' | translate}}</span>
                                </uib-tab-heading>
                                <div class="row animated fadeIn">
                                    <div class="col-12 col-md-6 col-lg-3 mb-4">
                                        <div class="card bg-lazur h-100 text-white text-center">
                                            <div class="card-body px-2 py-3">
                                                <h5 class="text-capitalize mb-0">{{'TOTAL_AMOUNT_BORROWED' | translate}}</h5>
                                                <small>&nbsp;</small>
                                                <h1>£{{vm.dealRes.fixedTerm.mortgageBalance | number : 2}}</h1>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-12 col-md-6 col-lg-3 mb-4">
                                        <div class="card bg-purple h-100 text-white text-center">
                                            <div class="card-body px-2 py-3">
                                                <h5 class="text-capitalize mb-0">{{'COST' | translate}}</h5>
                                                <small><em>{{'COST_SUB_INFO' | translate}}</em></small>
                                                <h1>£{{vm.dealRes.summary.cost.wholeTerm | number : 2}}</h1>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-12 col-md-6 col-lg-3 mb-4">
                                        <div class="card bg-lazur h-100 text-white text-center">
                                            <div class="card-body px-2 py-3">
                                                <h5 class="text-capitalize mb-0">{{'TOTAL_PAID' | translate}}</h5>
                                                <small>&nbsp;</small>
                                                <h1>£{{vm.dealRes.summary.payments.wholeTerm | number : 2}}</h1>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-12 col-md-6 col-lg-3 mb-4">
                                        <div class="card bg-lazur h-100 text-white text-center">
                                            <div class="card-body px-2 py-3">
                                                <h5 class="mb-0">{{'COST_PER_1_POUND' | translate}}</h5>
                                                <small>&nbsp;</small>
                                                <h1>£{{(vm.dealRes.summary.payments.wholeTerm + vm.dealRes.summary.valuationFee.wholeTerm + vm.dealRes.summary.bookingFee.wholeTerm) / vm.dealRes.summary.capitalGain.wholeTerm | number : 2}}</h1>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </uib-tab>
                        </uib-tabset>
                    </div>
                </div>
            </uib-tab>
            <uib-tab>
                <uib-tab-heading>
                    <span class="text-capitalize">{{'CHARTS' | translate}}</span>
                </uib-tab-heading>
                <div class="card bg-transparent border-0" ng-class="{'no-corner-border': vm.dealRes.activeTab === 0}">
                    <div class="card-body animated fadeIn">
                        <div class="row">
                            <div class="col-xs-offset-2 col-xs-8 col-md-offset-0 col-md-3">
                                <div class="chart-doughnut-container">
                                    <canvas id="doughnut" class="chart chart-doughnut" chart-data="vm.dealRes.chartDoughnut.data" chart-labels="vm.dealRes.chartDoughnut.labels"  chart-colors="vm.dealRes.chartDoughnut.colors" chart-options="vm.dealRes.chartDoughnut.options" height="250"></canvas>
                                </div>
                            </div>
                            <div class="col-xs-12 col-md-9">
                                <div class="chart-line-container">
                                    <canvas id="line" class="chart chart-line" chart-data="vm.dealRes.chartLine.data" chart-labels="vm.dealRes.chartLine.labels" chart-colors="vm.dealRes.chartLine.colors" chart-series="vm.dealRes.chartLine.series" chart-options="vm.dealRes.chartLine.options" height="100"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </uib-tab>
            <uib-tab>
                <uib-tab-heading>
                    <span class="text-capitalize">
                        <span class="d-none d-md-block">{{'MORTGAGE_SUMMARY' | translate}}</span>
                        <span class="d-md-none">{{'MORTGAGE_SUMMARY_SM' | translate}}</span>
                    </span>
                </uib-tab-heading>
                <div class="card bg-transparent border-0" ng-class="{'no-corner-border': vm.activeTab === 0}">
                    <div class="card-body animated fadeIn">
                        <table class="table table-condensed table-striped table-hover table-small-font">
                            <thead>
                            <tr>
                                <th width="25%"><span>&nbsp;</span></th>
                                <th width="24%"><span class="text-capitalize">{{'INITIAL_TERM' | translate}}</span></th>
                                <th width="26%"><span class="text-capitalize">{{'REMAINING_TERM' | translate}}</span></th>
                                <th width="25%"><span class="text-capitalize">{{'WHOLE_TERM' | translate}}</span></th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <th><span class="text-capitalize">{{'PAYMENTS' | translate}}</span></th>
                                <td>£{{vm.dealRes.summary.payments.fixedTerm | number : 2}}</td>
                                <td>£{{vm.dealRes.summary.payments.remainingTerm | number : 2}}</td>
                                <td>£{{vm.dealRes.summary.payments.wholeTerm | number : 2}}</td>
                            </tr>
                            <tr>
                                <th><span class="text-capitalize">{{'INTERESTS' | translate}}</span></th>
                                <td>£{{vm.dealRes.summary.interests.fixedTerm | number : 2}}</td>
                                <td>£{{vm.dealRes.summary.interests.remainingTerm | number : 2}}</td>
                                <td>£{{vm.dealRes.summary.interests.wholeTerm | number : 2}}</td>
                            </tr>
                            <tr>
                                <th><span class="text-capitalize">{{'VALUATION_FEE' | translate}}</span></th>
                                <td>£{{vm.dealRes.summary.valuationFee.fixedTerm | number : 2}}</td>
                                <td>£{{vm.dealRes.summary.valuationFee.remainingTerm | number : 2}}</td>
                                <td>£{{vm.dealRes.summary.valuationFee.wholeTerm | number : 2}}</td>
                            </tr>
                            <tr>
                                <th><span class="text-capitalize">{{'BOOKING_FEE' | translate}}</span></th>
                                <td>£{{vm.dealRes.summary.bookingFee.fixedTerm | number : 2}}</td>
                                <td>£{{vm.dealRes.summary.bookingFee.remainingTerm | number : 2}}</td>
                                <td>£{{vm.dealRes.summary.bookingFee.wholeTerm | number : 2}}</td>
                            </tr>
                            <tr>
                                <th><span class="text-capitalize">{{'COST' | translate}}</span></th>
                                <td>£{{vm.dealRes.summary.cost.fixedTerm | number : 2}}</td>
                                <td>£{{vm.dealRes.summary.cost.remainingTerm | number : 2}}</td>
                                <td>£{{vm.dealRes.summary.cost.wholeTerm | number : 2}}</td>
                            </tr>
                            <tr>
                                <th><span class="text-capitalize">{{'CAPITAL_GAIN' | translate}}</span></th>
                                <td>£{{vm.dealRes.summary.capitalGain.fixedTerm | number : 2}}</td>
                                <td>£{{vm.dealRes.summary.capitalGain.remainingTerm | number : 2}}</td>
                                <td>£{{vm.dealRes.summary.capitalGain.wholeTerm | number : 2}}</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </uib-tab>
            <uib-tab>
                <uib-tab-heading>
                    <span class="text-capitalize">
                        <span class="d-none d-md-block">{{'TERM_SUMMARY' | translate}}</span>
                        <span class="d-md-none">{{'TERM_SUMMARY_SM' | translate}}</span>
                    </span>
                </uib-tab-heading>
                <div class="card bg-transparent border-0" ng-class="{'no-corner-border': vm.dealRes.activeTab === 0}">
                    <div class="card-body animated fadeIn">
                        <div class="row">
                            <div class="col-sm-6">
                                <table class="table table-striped  table-hover">
                                    <thead>
                                    <tr>
                                        <th colspan="2" class="text-center">{{'TERM_SUMMARY_INITIAL_MONTHS' | translate: {fixedTermTerm: vm.dealRes.fixedTerm.term} }}</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr>
                                        <th><span class="text-capitalize">{{'RATE' | translate}}</span></th>
                                        <td>{{vm.dealRes.fixedTerm.rate | number : 2}}%</td>
                                    </tr>
                                    <tr>
                                        <th><span class="text-capitalize">{{'MONTHLY_RATE' | translate}}</span></th>
                                        <td>{{vm.dealRes.fixedTerm.monthlyRate | number : 4}}%</td>
                                    </tr>
                                    <tr>
                                        <th><span class="text-uppercase">{{'NPER' | translate}}</span></th>
                                        <td>{{vm.dealRes.fixedTerm.nper | number : 0}} months</td>
                                    </tr>
                                    <tr>
                                        <th><span class="text-capitalize">{{'MORTGAGE_BALANCE' | translate}}</span></th>
                                        <td>£{{vm.dealRes.fixedTerm.mortgageBalance | number : 2}}</td>
                                    </tr>
                                    <tr>
                                        <th><span class="text-capitalize">{{'MONTHLY_PAYMENTS' | translate}}</span></th>
                                        <td>£{{vm.dealRes.fixedTerm.monthlyPayments | number : 2}}</td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="col-sm-6">
                                <table class="table table-striped table-hover">
                                    <thead>
                                    <tr>
                                        <th colspan="2" class="text-center">{{'TERM_SUMMARY_REMAINING_MONTHS' | translate: {remainingTermTerm: vm.dealRes.remainingTerm.term} }}</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr>
                                        <th><span class="text-capitalize">{{'RATE' | translate}}</span></th>
                                        <td>{{vm.dealRes.remainingTerm.rate | number : 2}}%</td>
                                    </tr>
                                    <tr>
                                        <th><span class="text-capitalize">{{'MONTHLY_RATE' | translate}}</span></th>
                                        <td>{{vm.dealRes.remainingTerm.monthlyRate | number : 4}}%</td>
                                    </tr>
                                    <tr>
                                        <th><span class="text-uppercase">{{'NPER' | translate}}</span></th>
                                        <td>{{vm.dealRes.remainingTerm.nper | number : 0}} months</td>
                                    </tr>
                                    <tr>
                                        <th><span class="text-capitalize">{{'MORTGAGE_BALANCE' | translate}}</span></th>
                                        <td>£{{vm.dealRes.remainingTerm.mortgageBalance | number : 2}}</td>
                                    </tr>
                                    <tr>
                                        <th><span class="text-capitalize">{{'MONTHLY_PAYMENTS' | translate}}</span></th>
                                        <td>£{{vm.dealRes.remainingTerm.monthlyPayments | number : 2}}</td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </uib-tab>
            <uib-tab>
                <uib-tab-heading>
                    <span class="text-capitalize">{{'BREAKDOWNS' | translate}}</span>
                </uib-tab-heading>
                <div class="card bg-transparent border-0" ng-class="{'no-corner-border': vm.dealRes.activeTab === 0}">
                    <div class="card-body animated fadeIn">
                        <table class="table table-condensed table-striped table-hover table-small-font">
                            <thead>
                            <tr>
                                <th width="8%">
                                    <div class="text-capitalize">
                                        <span class="d-none d-md-block">{{'MONTHS' | translate}}</span>
                                        <span class="d-md-none">{{'MONTHS_SM' | translate}}</span>
                                    </div>
                                </th>
                                <th width="12%"><span class="text-capitalize">{{'BALANCE' | translate}}</span></th>
                                <th width="12%"><span class="text-capitalize">{{'RATE' | translate}}</span></th>
                                <th width="17%"><span class="text-capitalize">{{'YEARLY_INTEREST' | translate}}</span></th>
                                <th width="17%"><span class="text-capitalize">{{'MONTHLY_INTEREST' | translate}}</span></th>
                                <th width="17%"><span class="text-capitalize">{{'MONTHLY_PAYMENT' | translate}}</span></th>
                                <th width="17%"><span class="text-capitalize">{{'MONTHLY_CAPITAL_GAIN' | translate}}</span></th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr ng-repeat="row in vm.dealRes.fixedTerm.table" tabindex="0">
                                <td>{{$index + 1}}</td>
                                <td>£{{row.balance | number : 2}}</td>
                                <td>{{row.rate | number : 2}}%<span data-bind="text: rate + '%'"></span></td>
                                <td>£{{row.yearlyInterest | number : 2}}</td>
                                <td>£{{row.monthlyInterest | number : 2}}</td>
                                <td>£{{row.monthlyPayment | number : 2}}</td>
                                <td>£{{row.monthlyCapitalGain | number : 2}}</td>
                            </tr>
                            </tbody>
                        </table>

                        <table class="table table-condensed table-striped table-hover table-small-font">
                            <thead>
                            <tr>
                                <th width="8%">
                                    <div class="text-capitalize">
                                        <span class="d-none d-md-block">{{'MONTHS' | translate}}</span>
                                        <span class="d-md-none">{{'MONTHS_SM' | translate}}</span>
                                    </div>
                                </th>
                                <th width="12%"><span class="text-capitalize">{{'BALANCE' | translate}}</span></th>
                                <th width="12%"><span class="text-capitalize">{{'RATE' | translate}}</span></th>
                                <th width="17%"><span class="text-capitalize">{{'YEARLY_INTEREST' | translate}}</span></th>
                                <th width="17%"><span class="text-capitalize">{{'MONTHLY_INTEREST' | translate}}</span></th>
                                <th width="17%"><span class="text-capitalize">{{'MONTHLY_PAYMENT' | translate}}</span></th>
                                <th width="17%"><span class="text-capitalize">{{'MONTHLY_CAPITAL_GAIN' | translate}}</span></th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr ng-repeat="row in vm.dealRes.remainingTerm.table" tabindex="0">
                                <td>{{$index + 1}}</td>
                                <td>£{{row.balance | number : 2}}</td>
                                <td>{{row.rate | number : 2}}%<span data-bind="text: rate + '%'"></span></td>
                                <td>£{{row.yearlyInterest | number : 2}}</td>
                                <td>£{{row.monthlyInterest | number : 2}}</td>
                                <td>£{{row.monthlyPayment | number : 2}}</td>
                                <td>£{{row.monthlyCapitalGain | number : 2}}</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </uib-tab>
        </uib-tabset>
    </div>
</div>